webpackJsonp([1],{"3Fm9":function(e,t){},"9tUg":function(e,t){},CMfc:function(e,t){},E0jK:function(e,t){window,window.Dict={fileType:{"DOC,DOCX":"word","XLS,XLSX":"excel",TXT:"txt",PPT:"ppt",PDF:"pdf",MP3:"music","MP4,AVI,RMVB,FLV":"video","ZIP,RAR,7Z":"package",default:"undefined"},getUserId:function(){var e=[];["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"].forEach(function(t){e.push(t),e.push(t.toLocaleUpperCase())});for(var t=0;t<10;t++)e.push(t);for(var i=[],n=e.length,a=0;a<n;a++)i.push(e.splice(Math.floor(Math.random()*e.length),1)[0]);return function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=[],a=0;a<e;a++)t.push(i[Math.floor(Math.random()*n)]);return t.join("")}}(),emojiList:[{icon:"1wx",label:"微笑"},{icon:"2ws",label:"哇塞"},{icon:"3ng",label:"难过"},{icon:"4tp",label:"调皮"},{icon:"5cy",label:"呲牙"},{icon:"6smm",label:"色眯眯"},{icon:"7xmm",label:"笑眯眯"},{icon:"8jy",label:"惊讶"},{icon:"9lh",label:"刘海"},{icon:"10tst",label:"吐舌头"},{icon:"11zh",label:"憎恨"},{icon:"12kx",label:"哭笑"},{icon:"13xz",label:"吓着"},{icon:"14qq",label:"亲亲"},{icon:"15hgg",label:"好尴尬"},{icon:"16wq",label:"委屈"},{icon:"17lh",label:"冷汗"},{icon:"18kz",label:"口罩"},{icon:"19sj",label:"睡觉"},{icon:"20dx",label:"担心"},{icon:"21nh",label:"怒火"},{icon:"22dy",label:"得意"},{icon:"23fn",label:"愤怒"},{icon:"24dyl",label:"独眼龙"},{icon:"25tx",label:"偷笑"},{icon:"26yk",label:"愉快"},{icon:"27bs",label:"鄙视"},{icon:"28dk",label:"大哭"},{icon:"29cm",label:"财迷"},{icon:"30xy",label:"眩晕"},{icon:"32kq",label:"哭泣"},{icon:"33ty",label:"晕"},{icon:"34hp",label:"害怕"},{icon:"35bz",label:"闭嘴"},{icon:"36kbz",label:"抠鼻子"},{icon:"37fd",label:"发抖"},{icon:"38bb",label:"拜拜"},{icon:"39yw",label:"疑问"},{icon:"40s",label:"衰"},{icon:"41kbj",label:"眼瞎"},{icon:"42sq",label:"生气"},{icon:"43xd",label:"心动"},{icon:"44xs",label:"心碎"},{icon:"45xw",label:"学问"},{icon:"46js",label:"沮丧"},{icon:"47sx",label:"伤心"},{icon:"48yc",label:"忧愁"},{icon:"49nb",label:"棒"},{icon:"50ok",label:"好的"},{icon:"51qt",label:"晴天"},{icon:"52dy",label:"多云"},{icon:"53xy",label:"下雨"},{icon:"54yt",label:"阴天"},{icon:"31666",label:"666"}],findFileType:function(e){if(!e)return this.fileType.default;for(var t in e=e.toLocaleUpperCase(),this.fileType)if(-1!=t.indexOf(e))return this.fileType[t];return this.fileType.default},contentType:{text:1,voice:2,img:3,file:4}}},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("7+uW");window.timerBase={};var a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=i("VU/8")({name:"App"},a,!1,function(e){i("pNF5")},null,null).exports,o=i("/ocq"),r=i("Dd8w"),l=i.n(r),c={name:"iconButton",props:{icon:String,image:"",notHover:!1,disabled:Boolean},methods:{getStyle:function(){var e={};return this.icon&&(e.background="url('/static/images/buttonIcon/"+this.icon+".png')"),this.image&&(e.background="url("+this.image+")"),e},handleClick:function(e){this.disabled||this.$emit("click",e)}}},u={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{class:"xie-icon-button "+(this.notHover?"notHover":""),style:this.getStyle(),attrs:{disabled:this.disabled},on:{click:this.handleClick}})},staticRenderFns:[]};var d={name:"messageInput",components:{iconButton:i("VU/8")(c,u,!1,function(e){i("aWaW")},"data-v-62048667",null).exports},props:{isNow:{type:Boolean,default:function(e){return!1}},client:{type:Boolean,default:function(e){return!0}},isnotsend:{type:Boolean,default:function(e){return!0}},disabled:Boolean,fileUrl:{type:String,default:function(e){return location.origin}},uploadUrl:String},data:function(){return{emojiUrl:"/static/images/emoji/",fileList:[],messageInput:{},currentObj:{},emojivisible:!1,fileUploadObj:{},fileState:!0}},created:function(){var e=this;this.messageInputClick=Util.antiShakeFactory(function(t){e.messageInputClickfn(t)},100),this.initUpload=Util.antiShakeFactory(function(e){Util.FunctionChain(!0)},300)},mounted:function(){var e=this;this.messageInput=document.getElementById("message-input"),this.$emit("getDom",this.messageInput),this.messageInput.click(),this.messageInput.addEventListener("paste",function(t){var i=(t.clipboardData||window.clipboardData).items[0];if(i)if("string"==i.kind)i.getAsString(function(i){var n=i.match(/<img src=([^>]*)>/);(n=n?n[0]:n)&&(n=(n=(n=n.match(/"[^"]*/))?n[0]:n).substr(1),e.emojiClick(t,n),t.preventDefault())});else if("file"==i.kind){var n=i.getAsFile();n.state=!0,n.screenshot=!0,Util.FunctionChain(function(){e.fileState=!1,e.$refs.imageupload.handleStart(n),e.$refs.imageupload.submit()}),e.initUpload(),t.preventDefault()}})},methods:{initUpload:function(){},isType:function(e){return Object.prototype.toString.call(e)},messageInputClick:function(){},messageInputClickfn:function(e){if(this.convertText(),13==(e.keyCode||e.which||e.charCode||0)){if(this.disabled)return;e.ctrlKey?this.enterRangeContent():(event?e.returnValue=!1:e.preventDefault(),this.onSubmit())}else this.currentObj.range=document.createRange(),this.currentObj.sel=document.getSelection(),this.currentObj.dom=document.getSelection().focusNode,this.currentObj.offset=this.currentObj.sel.focusOffset},enterRangeContent:function(){var e=document.createRange(),t=document.getSelection(),i=t.focusOffset,n=document.getSelection().focusNode;if(this.messageInput.innerHTML){var a=document.createElement("div");if("[object Text]"==Object.prototype.toString.call(n))0===i?(a.appendChild(document.createElement("br")),n.before(a),e.setStart(n,0)):n.length==i?(a.appendChild(document.createElement("br")),n.after(a),e.setStart(a,0)):(a.appendChild(n.splitText(i)),n.after(a),e.setStart(a,0));else{var s=n.childNodes[i-1],o=n.childNodes[i];if(0===i)a.appendChild(document.createElement("br")),o.before(a),e.setStart(o,0);else if(n.childNodes.length==i)a.appendChild(document.createElement("br")),s.after(a),e.setStart(a,0);else{for(var r,l=document.createElement("div"),c=0;r=n.childNodes[0];c++)c<i?a.appendChild(r):l.appendChild(r);n.appendChild(a),n.appendChild(l),e.setStart(l,0)}}e.collapse(!0),t.removeAllRanges(),t.addRange(e)}},convertText:function(){for(var e,t=0;e=document.querySelectorAll("#message-input *")[t++];){for(var i,n=0;i=e.attributes[n++];)-1=="href,src,target,class".indexOf(i.name)&&e.removeAttribute(i.name);switch(this.isType(e)){case"[object HTMLPreElement]":e.outerHTML=e.innerHTML;break;case"[object HTMLAnchorElement]":e.setAttribute("target","_blank");break;case"[object HTMLImageElement]":this.handelImg(e)}}},handelImg:function(e){var t,i,n,a=this,s={png:"png",jpeg:"jpg",gif:"gif","svg+xml":"svg","x-icon":"ico",bmp:"bmp"},o=e.getAttribute("src").match(/data:image\/(\S*);base64,/);o=o?o[1]:null,s[o]&&(this.isnotsend?(e.outerHTML="",Util.openalert("非客服状态不能发送截图")):(Util.FunctionChain((t=e,i=Util.getUserId(20)+"."+s[o],n="image/"+s[o],function(){a.dataURLtoFile(t,i,n)})),this.initUpload()))},dataURLtoFile:function(e,t,i){if(-1==e.getAttribute("src").indexOf("http")){for(var n=e.getAttribute("src").split(","),a=window.atob(n[1]),s=a.length,o=new Uint8Array(s);s--;)o[s]=a.charCodeAt(s);var r=new File([o],t,{type:i});r.state=!0,r.dom=e,this.$refs.imageupload.handleStart(r),this.$refs.imageupload.submit()}},getNodeIndex:function(e,t){for(var i,n=0,a=0;i=e[a++];)if(t.isSameNode(i))return a;return n},emojiClick:function(e,t){var i=t||e.target.style.background.split('"')[1],n=document.createElement("img");n.src=i,t||(n.className="emoji");var a=this.currentObj,s=a.range,o=a.sel,r=a.dom,l=a.offset;if(!r)return(r=this.messageInput).append(n),s.setStart(r,1),this.currentObj.dom=n,s.collapse(!0),o.removeAllRanges(),o.addRange(s),void(this.emojivisible=!1);if("[object Text]"==Object.prototype.toString.call(r))0==l?(r.before(n),this.currentObj.dom=n,s.setStart(r,0)):r.length==l?(r.after(n),this.currentObj.dom=n,s.setStart(r.parentNode,this.getNodeIndex(r.parentNode.childNodes,r)+1)):(r.splitText(this.currentObj.offset),r.after(n),this.currentObj.dom=n,s.setStart(r.parentNode,this.getNodeIndex(r.parentNode.childNodes,r)+1));else{var c=r.childNodes[l-1],u=r.childNodes[l];r.isSameNode(this.messageInput)?(0===l&&r.childNodes.length?(u.before(n),s.setStart(r,1)):0===l&&!r.childNodes.length||l==r.childNodes.length?(r.append(n),s.setStart(r,r.childNodes.length)):(c.after(n),s.setStart(r,this.getNodeIndex(r.childNodes,u)-1)),this.currentObj.dom=n):"<br>"==r.innerHTML?(r.innerHTML="",r.appendChild(n),this.currentObj.dom=n,s.setStart(r,1)):(r.after(n),this.currentObj.dom=n,s.setStart(r.parentNode,this.getNodeIndex(r.parentNode.childNodes,r)+1))}s.collapse(!0),o.removeAllRanges(),o.addRange(s),this.emojivisible=!1},beforeFile:function(e,t){var i=void 0;if(-1!=t.name.lastIndexOf(".")&&(i=(i=t.name.substr(t.name.lastIndexOf(".")+1)).toLocaleUpperCase()),!i||-1==["EXE","ZIP","RAR","JPG","PNG","GIF","PDF","SVG","DOC","DOCX","XLS","XLSX","TXT","PPT","MP4","AVI","RMVB","FLV"].indexOf(i))return Util.openalert("该文件类型不支持！"),!1;var n="file"+Date.now();return this.fileUploadObj[n]={uuid:n,uploadFile:!0,uploadstate:1,percent:0,content:"<div class=\"file-info\"><span class='flie-name'>"+t.name+"</span><span class='file-size'>"+Util.getFileSize(t.size)+'</span></div><span class="filetype-icon '+(Dict.findFileType(i)||"undefined")+'"></span>',createtime:new Date,state:!1,iscustomer:!1},t.uuid=n,-1==t.type.indexOf("image/")?t.size<=524288e3?void this.$emit("uploadFile",this.fileUploadObj[n]):(Util.openalert("上传文件不能大于500MB"),this.$refs[e]&&(this.$refs[e].clearFiles(),this.$refs[e].abort(t)),!1):void 0},successFile:function(e,t,i){if(i.raw.state)i.raw.screenshot?this.emojiClick(null,this.fileUrl+t.object):i.raw.dom.setAttribute("src",this.fileUrl+t.object),this.initUpload(),this.fileState=!0;else if(1==t.code){this.fileUploadObj[i.raw.uuid].uploadstate=2;var n=l()({},t,{fileresult:{fileStr:"",type:""}});-1!=i.raw.type.indexOf("image/")?(n.fileresult.fileStr="[image/img]("+t.object+")",n.fileresult.type="img"):(n.fileresult.fileStr="[file/"+i.name+"\\*\\"+i.size+"]("+t.object+")",n.fileresult.type="file"),this.$emit("uploadFile",this.fileUploadObj[i.raw.uuid],n,i),delete this.fileUploadObj[i.raw.uuid]}else this.fileUploadObj[i.raw.uuid].uploadstate=3,Util.openalert("未知错误");this.$refs[e]&&this.$refs[e].clearFiles()},errorFile:function(e,t,i){this.fileUploadObj[i.raw.uuid].percent=100,this.fileUploadObj[i.raw.uuid].uploadstate=3,delete this.fileUploadObj[i.raw.uuid],this.$refs[e]&&this.$refs[e].clearFiles(),i.raw.state&&this.initUpload()},progressFile:function(e,t,i){this.fileUploadObj[i.raw.uuid].percent=Math.floor(t.percent)},forwardMan:function(e){this.disabled||this.$emit("forwardMan")},iconClick:function(e){this.disabled||("emoji"!==e?this.$emit("iconClick",e):this.emojivisible=!this.emojivisible)},getConvertContent:function(){for(var e=!0;e;){var t,i=0;for(e=!1;t=document.querySelectorAll("#message-input *")[i++];)if("[object HTMLImageElement]"==this.isType(t)){var n="";n="emoji"==t.className?"[image/emoji]("+t.src.split(location.origin)[1]+")":"[image/img]("+(t.src.split(this.fileUrl)[1]||t.src.split(this.fileUrl)[0])+")",t.outerHTML=n,e=!0;break}}var a=this.messageInput.innerHTML;return this.messageInput.innerHTML="",this.messageInput.focus(),this.currentObj.dom=null,a},onSubmit:function(e){if(this.fileState){var t=this.getConvertContent();if(!this.disabled&&function(e){var t=e.split("&nbsp;").join("");return t=(t=(t=(t=t.split(" ").join("")).split("<div>").join("")).split("</div>").join("")).split("<br>").join("")}(t)){var i={dom:this.messageInput,result:t};this.$emit("click",i)}}}}},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"xie-message-input-warp",attrs:{disabled:e.disabled}},[i("div",{ref:"messageDIV",attrs:{id:"message-input",contenteditable:!e.disabled,disabled:e.disabled},on:{click:function(t){return e.messageInputClick(t)},keyup:e.messageInputClick,keydown:function(e){13==e.keyCode&&(e.returnValue=!1,e.preventDefault())},input:e.messageInputClick}}),e._v(" "),i("div",{staticClass:"tool-warp"},[i("div",{staticClass:"tool"},[i("el-tooltip",{attrs:{content:"表情",effect:"light"}},[i("icon-button",{staticStyle:{"margin-right":"20px"},attrs:{disabled:e.disabled,icon:"emoji"},on:{click:function(t){return e.iconClick("emoji")}}})],1),e._v(" "),i("el-upload",{ref:"fileupload",staticStyle:{"margin-right":"20px",height:"25px"},attrs:{action:e.uploadUrl,data:{type:4},"before-upload":function(t){return e.beforeFile("imageupload",t)},"on-success":function(t,i){e.successFile("imageupload",t,i)},"on-error":function(t,i){e.errorFile("imageupload",t,i)},"on-progress":function(t,i){e.progressFile("imageupload",t,i)},"show-file-list":!1,disabled:e.disabled||e.isnotsend,"file-list":e.fileList}},[i("el-tooltip",{attrs:{content:"文件",effect:"light"}},[i("icon-button",{attrs:{disabled:e.disabled||e.isnotsend,icon:"file"},on:{click:function(t){return e.iconClick("file")}}})],1)],1),e._v(" "),i("el-upload",{ref:"imageupload",staticStyle:{"margin-right":"20px",height:"25px"},attrs:{accept:"image/*",action:e.uploadUrl,data:{type:3},"before-upload":function(t){return e.beforeFile("imageupload",t)},"on-success":function(t,i){e.successFile("imageupload",t,i)},"on-error":function(t,i){e.errorFile("imageupload",t,i)},"on-progress":function(t,i){e.progressFile("imageupload",t,i)},"show-file-list":!1,disabled:e.disabled||e.isnotsend,"file-list":e.fileList}},[i("el-tooltip",{attrs:{content:"图片",effect:"light"}},[i("icon-button",{attrs:{disabled:e.disabled||e.isnotsend,icon:"image"},on:{click:function(t){return e.iconClick("image")}}})],1)],1),e._v(" "),i("el-tooltip",{attrs:{content:"功能按钮",effect:"light"}},[i("icon-button",{attrs:{disabled:e.disabled,icon:"rate"}})],1)],1),e._v(" "),i("el-button",{attrs:{disabled:e.disabled,size:"small",round:""},on:{click:e.onSubmit}},[e._v("发 送")])],1),e._v(" "),e.emojivisible?i("div",{staticClass:"emoji-warp"},e._l(e.$emojiArr,function(t,n){return i("el-tooltip",{key:n,attrs:{effect:"light",content:t.label}},[i("i",{staticClass:"emoji",style:{background:"url('"+e.emojiUrl+t.icon+".png')"},on:{click:e.emojiClick}})])}),1):e._e()])},staticRenderFns:[]};var f=i("VU/8")(d,p,!1,function(e){i("CMfc"),i("3Fm9")},"data-v-1d7b4dba",null).exports,m={name:"avatarIcon",props:{icon:String,image:String,online:{type:Boolean,default:!0},busy:{type:Boolean,default:!1},state:{type:Boolean,default:!1}},methods:{getStyle:function(){var e={};return this.icon&&(e.background="url('/static/images/avatar/"+this.icon+".png')"),this.image&&(e.background="url("+this.image+")"),e},handleClick:function(e){this.$emit("click",e)}}},h={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{class:"xie-avatar "+(this.state?"state":""),style:this.getStyle(),attrs:{busy:this.busy,online:this.online}})},staticRenderFns:[]};var g={name:"chatMessage",components:{avatarIcon:i("VU/8")(m,h,!1,function(e){i("SRUc")},"data-v-9d7a9434",null).exports},props:{receiverObj:{},messageList:{type:Array,default:function(e){return[]}},userType:String,fileUrl:String,havemsg:{type:Boolean,default:!0},showRead:{type:Boolean,default:!0}},data:function(){return{uploadstate:{1:{text:"上传进度",color:"#588AFD"},2:{text:"上传成功",color:"#17CB3D"},3:{text:"上传失败",color:"#EA4E30"}},waitNum:0,scrollTop:0,scrollHeight:0,notbottomMsgNum:0}},watch:{receiverObj:function(e,t){this.warptoBottom()}},mounted:function(){var e=this;this.$refs.messageWarp.onscroll=Util.throttleFactory(function(){e.$refs.messageWarp.scrollTop+e.$refs.messageWarp.clientHeight>=e.$refs.messageWarp.scrollHeight-70&&(e.notbottomMsgNum=0)},200)},methods:{getFormattedText:function(e){for(var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0;n;){n=!1;var a=e.match(/\[\w{4,5}([^\]]*)\]\(([^\)]*)\)/);if(a){n=!0;var s=(a=a[0]).match(/\S{1}([^\/]{4,5})/);s=s?s[1]:s;var o=a.match(/\/([^\]]*)/);o=o?o[1]:o;var r=a.match(/\]\([^\)]*/);if(r=r?r[0].substr(2):r,"image"==s)if("img"==o){var l=new Image,c=this.fileUrl+r;-1!=r.indexOf("http")&&(c=r),l.src=c,l.onload=function(){t.warptoBottom()},e=this.insertHTML(e,{pendingText:a,type:"img",subname:o,src:c},i)}else e=this.insertHTML(e,{pendingText:a,type:"emoji",subname:o,src:r},i);else if("file"==s){e.match(/\[([^\)]*)\)/);var u=o.split("\\*\\");o=u[0];var d=void 0,p=Util.getFileSize(u[1]||0);-1!=o.lastIndexOf(".")&&(d=o.substr(o.lastIndexOf(".")+1)),e=this.insertHTML(e,{pendingText:e,type:"file",fileType:Dict.findFileType(d),subname:o,fileSize:p,src:r},i)}}}return e},insertHTML:function(e,t,i){for(var n={img:'<img preview style="width: 200px;" src="'+t.src+'" />',emoji:'<img src="'+t.src+'" class="emoji" />',file:'<div class="download-warp">\n                    <div class="file-info">\n                      <span class="file-name">'+t.subname+'</span>\n                      <span class="file-size">'+t.fileSize+'</span>\n                    </div>\n                    <span class="filetype-icon '+(t.fileType||"undefined")+'"></span>\n                  </div>\n                  <a upload target="_blank" href="'+(this.fileUrl+t.src)+'" download="'+t.subname+'">下载</a>'},a=i?{img:"[图片]",emoji:"[表情]",file:"[文件]"}:n,s=e.split(t.pendingText),o=0;o<s.length;o++)0!=o&&(s[o]=a[t.type]+s[o]);return s.join("")},getHTML:function(e){var t=this.getFormattedText(e);return this.addElementNodeClick("img[preview]",function(){Util.openpreview(this.src)}),t},addElementNodeClick:function(e,t){this.$nextTick().then(function(){for(var i,n=0;i=document.querySelectorAll(e)[n++];)i.onclick||(i.onclick=t)})},hintClick:function(){this.warptoBottom(),this.notbottomMsgNum=0},getavatar:function(e){var t=e.usertype,i=e.avatar,n="user"==t;return"user"==this.userType?n?"client":i||"main":n?i||"main":"client"},moreClick:function(e){this.$emit("moreClick")},addMessage:function(e,t){var i=e(),n=!!this.userType==!!i.usertype,a=this.scrollTop>this.$refs.messageWarp.scrollTop;t?(this.scrollHeight||(this.scrollHeight=this.$refs.messageWarp.scrollHeight),this.warptoStop(this.scrollHeight)):n?this.warptoBottom():a&&!i.tip?this.notbottomMsgNum++:this.warptoBottom()},warptoBottom:function(){var e=this;this.$nextTick().then(function(){e.$refs.messageWarp.scrollTop=e.$refs.messageWarp.scrollHeight,e.scrollTop=e.$refs.messageWarp.scrollTop})},warptoStop:function(e){var t=this;this.$nextTick().then(function(){t.$refs.messageWarp.scrollTop=t.$refs.messageWarp.scrollHeight-e})},getDiffTime:function(e,t){var i=e[t],n=e[t-1];return n?i.createtime-n.createtime:i.createtime},getTime:function(e){var t=new Date(e);return t.toLocaleDateString()+" "+t.toTimeString().split(" ")[0]}}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"messageWarp",staticClass:"message-warp"},[i("div",{staticClass:"message-item-moremsg"},[e.havemsg?i("el-button",{attrs:{size:"mini"},on:{click:e.moreClick}},[e._v("更多记录")]):[e._v("没有更多了")]],2),e._v(" "),e._l(e.messageList,function(t,n){return[e.getDiffTime(e.messageList,n)>12e4?i("div",{staticClass:"message-item-date"},[e._v(e._s(e.getTime(t.createtime)))]):e._e(),e._v(" "),t.tip?i("div",{staticClass:"message-item-tip"},[i("span",{domProps:{innerHTML:e._s(t.text)}})]):[e.userType==t.usertype?i("div",{staticClass:"message-item self"},[i("div",{staticClass:"message-content-warp"},[e.showRead?[t.isread?i("span",{staticClass:"state read"},[e._v("已读")]):i("span",{staticClass:"state"},[e._v("未读")])]:e._e(),e._v(" "),t.uploadFile?e._e():i("div",{staticClass:"message-content",domProps:{innerHTML:e._s(e.getHTML(t.content))}}),e._v(" "),t.uploadFile?i("div",{staticClass:"message-content"},[i("div",{staticClass:"download-warp",domProps:{innerHTML:e._s(t.content)}}),e._v(" "),t.percent<100?i("el-progress",{attrs:{color:"#2FDF54",percentage:t.percent}}):e._e(),e._v(" "),i("a",{style:{color:e.uploadstate[t.uploadstate].color},attrs:{upload:""}},[e._v(e._s(e.uploadstate[t.uploadstate].text))])],1):e._e()],2),e._v(" "),i("avatarIcon",{staticStyle:{margin:"15px 15px 15px 0"},attrs:{icon:e.getavatar(t)}})],1):i("div",{staticClass:"message-item"},[i("avatarIcon",{staticStyle:{margin:"15px 0 15px 15px"},attrs:{icon:e.getavatar(t)}}),e._v(" "),t.rate||t.uploadFile?e._e():i("div",{staticClass:"message-content",domProps:{innerHTML:e._s(e.getHTML(t.content))}})],1)]]}),e._v(" "),e.notbottomMsgNum?i("span",{staticClass:"hint",on:{click:e.hintClick}},[e._v("您有"+e._s(e.notbottomMsgNum<99?e.notbottomMsgNum:"99+")+"条新消息")]):e._e()],2)},staticRenderFns:[]};var b={name:"Index",components:{messageInput:f,chatMessage:i("VU/8")(g,v,!1,function(e){i("9tUg")},"data-v-0de7706f",null).exports},data:function(){return{fileUrl:"",userType:"user",InputDom:null,messageList:[],uploadUrl:"localhost:8080/uploadFile",havemsg:!0}},mounted:function(){var e=this;setTimeout(function(){for(var t=0;t<20;t++)e.addMessage(e.getMessageObj(t+Dict.getUserId(),Boolean(Math.round(Math.random()))?"user":""))},2e3)},methods:{addMessage:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$refs.chatMessage.addMessage(function(){return t.messageList.push(e),e},i)},onsubmit:function(e){var t=e.dom,i=e.result;this.addMessage(this.getMessageObj(i)),console.log(t,i)},uploadFile:function(e,t,i){if(t){var n=this.messageList.findIndex(function(t){return t===e});-1!=n&&this.messageList.splice(n,1)}else e.usertype="user",this.addMessage(e)},moreClick:function(){console.log("点击查看更多记录")},getMessageObj:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"发送失败";return{usertype:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",content:e,avatar:"",isread:!0,createtime:new Date}}}},y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"message-warp-g"},[i("div",{staticClass:"message-warp"},[i("chatMessage",{ref:"chatMessage",attrs:{havemsg:e.havemsg,fileUrl:e.fileUrl,messageList:e.messageList,userType:e.userType},on:{moreClick:e.moreClick}}),e._v(" "),i("div",{staticClass:"message-input-warp"},[i("messageInput",{attrs:{fileUrl:e.fileUrl,uploadUrl:e.uploadUrl,isnotsend:!1},on:{getDom:function(t){return e.InputDom=t},click:e.onsubmit,uploadFile:e.uploadFile}})],1)],1)])},staticRenderFns:[]};var w=i("VU/8")(b,y,!1,function(e){i("oH6Y")},"data-v-0a3ffbe8",null).exports;n.default.use(o.a);var S=new o.a({routes:[{path:"/",name:"index",component:w}]}),j=i("zL8q"),C=i.n(j),T=(i("tvR6"),i("MICi")),M=i.n(T),k=i("mvHQ"),x=i.n(k);!function(e){var t,i,n,a,s={};s.newmsgTip=(i=document.head.querySelector("title").innerHTML,(n=document.createElement("audio")).preload="auto",n.src="/static/music/hint.mp3",document.body.appendChild(n),{open:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"（您有新消息了）";e.musicPlay&&n.play();var s=!0;t&&clearInterval(t),e.timerBase.I1=t=setInterval(function(){document.head.querySelector("title").innerHTML=i+(s?a:""),s=!s},100)},close:function(){clearInterval(t),document.head.querySelector("title").innerHTML=i}}),s.openpreview=function(){var e=document.createElement("div");e.className="preview-img";var t=document.createElement("span");t.className="icon-close",e.appendChild(t);var i=document.createElement("img");return e.appendChild(i),document.body.appendChild(e),e.onclick=t.onclick=function(){e.className="preview-img",i.src=""},function(t){e.className="preview-img show",i.src=t}}(),s.getFileSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e=Number(e))<1024?e.toFixed(1)+["B","KB","MB","GB","TB"][t]:(e/=1024,s.getFileSize(e,t+1))},s.openalert=function(){var t=document.createElement("div");t.style.display="none";var i=document.createElement("span");return t.appendChild(i),document.body.appendChild(t),function(n){t.className="alert-tip",i.innerHTML=n,e.timerBase.w1=setTimeout(function(){t.className=0},2800)}}(),s.throttleFactory=function(t,i){return n=!0,function(){var a=arguments;n&&(n=!1,e.timerBase.f1=setTimeout(function(){t.apply(null,a),n=!0},i))};var n},s.antiShakeFactory=function(t,i){return n=null,function(){var a=arguments;clearTimeout(n),e.timerBase.f2=n=setTimeout(function(){t.apply(null,a)},i)};var n},s.FunctionChain=(a=[],function(){var e=[].shift.apply(arguments);if("[object Function]"==Object.prototype.toString.call(e))a.push(e);else if("[object Boolean]"==Object.prototype.toString.call(e)){var t=a.shift();t&&t.apply(null,arguments)}}),s.validatenull=function(e){if(e instanceof Array){if(0==e.length)return!0}else{if(!(e instanceof Object))return"null"==e||null==e||"undefined"==e||void 0==e||""==e;if("{}"===x()(e))return!0}return!1},s.getCorrectStr=function(e){if("[object String]"===Object.prototype.toString.call(e)){for(var t=!1,i=!1,n=e.split("").map(function(e){return"\t"===e?"  ":e}).join("").split("");!t||!i;)" "==n[0]?n.shift():t=!0," "==n[n.length-1]?n.pop():i=!0;return n.join("")}return e},s.validateJSON=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("[object String]"===Object.prototype.toString.call(e))try{return JSON.parse(e)}catch(i){return t?{}:s.validateJSON(s.getCorrectStr(e),!0)}return{}},s.getTime=function(e,t){if(!e)return"--";var i=new Date(e).getFullYear()+"",n=new Date(e).getMonth()+1>9?new Date(e).getMonth()+1:"0"+(new Date(e).getMonth()+1),a=new Date(e).getDate()>9?new Date(e).getDate():"0"+new Date(e).getDate(),s=new Date(i,0,1),o=Math.round((new Date(e).valueOf()-s.valueOf())/864e5),r=Math.ceil((o+(s.getDay()+1-1))/7),l=new Date(e).getHours()>9?new Date(e).getHours():"0"+new Date(e).getHours(),c=new Date(e).getMinutes()>9?new Date(e).getMinutes():"0"+new Date(e).getMinutes(),u=new Date(e).getSeconds()>9?new Date(e).getSeconds():"0"+new Date(e).getSeconds();return t=(t=(t=(t=(t=(t=(t=t.replace(/y+/,i)).replace(/m+/,n)).replace(/d+/,a)).replace(/h+/,l)).replace(/M+|min/,c)).replace(/s+/,u)).replace(/w+/,r)},s.addFns=function(){var e,t=[],i=[],n=0;return[].map.call(arguments,function(e,n){M()(e)&&(e=0);var a=e||0;i.push(Number(a));var s=a.toString().split(".")[1];t.push(s?s.toString().length:0)}),e=Math.max.apply(Math,t),t.map(function(t,a){for(var s=0;s<e;s++)i[a]=10*i[a];n+=Number(i[a])}),n/Math.pow(10,e)||0},s.floatSub=function(e,t){e=e||0,t=t||0;var i,n=void 0,a=void 0;try{n=e.toString().split(".")[1].length}catch(e){n=0}try{a=t.toString().split(".")[1].length}catch(e){a=0}return((e*(i=Math.pow(10,Math.max(n,a)))-t*i)/i).toFixed(n>=a?n:a)},s.accMul=function(e,t){e=e||0,t=t||0;var i=0,n=e.toString(),a=t.toString();try{i+=n.split(".")[1].length}catch(e){}try{i+=a.split(".")[1].length}catch(e){}return Number(n.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,i)},s.floatDiv=function(e,t){e=e||0,t=t||0;var i=0,n=0;try{i=e.toString().split(".")[1].length}catch(e){}try{n=t.toString().split(".")[1].length}catch(e){}return Number(e.toString().replace(".",""))/Number(t.toString().replace(".",""))*Math.pow(10,n-i)},e.Util=s}(window);i("E0jK");n.default.use(C.a),n.default.config.productionTip=!1,n.default.prototype.$emojiArr=Dict.emojiList,new n.default({el:"#app",router:S,components:{App:s},template:"<App/>"})},SRUc:function(e,t){},aWaW:function(e,t){},oH6Y:function(e,t){},pNF5:function(e,t){},tvR6:function(e,t){}},["NHnr"]);